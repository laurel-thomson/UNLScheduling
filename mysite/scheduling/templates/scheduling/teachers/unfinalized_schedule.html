{% extends 'base.html' %}

{% block content %}

<h2>Term Schedule</h2>
  
    <p>The schedule has not been finalized. <a href="{% url 'teachers:finalize_schedule' room.id term.id %}">Finalize the schedule</a></p>

    <h3>Time Preferences</h2>

    <form action="{% url 'teachers:update_schedule' room.id term.id %}" method="post">
        {% csrf_token %}
        {% for slot, data in schedule.items %}
            <strong><label>{{ slot }}</label></strong><br>
            {% for type, list in data.items %}
                {% if type == 'preferences' %}
                    {% for pref in list %}
                        <label for="{{pref.id}}">{{pref.user_id}} : Preference type = {{pref.preference_type}}</label>
                        <input type='checkbox' name="{{pref.id}}" id="{{pref.id}}"><br>
                    {% endfor %}
                {% elif type == 'scheduled_users' %}
                    {% for user in list %}
                        <label>Scheduled: {{user.user_id}}</label>
                    {% endfor %}
                {% endif %}
            {% endfor %}
        {% endfor %}

        <input type="submit" value="Submit" class="btn btn-primary">
    </form>

    <h3>Add time slot</h3>

    <form action="{% url 'teachers:add_time_slot' room.id term.id %}" method="post">
        {% csrf_token %}
        <table>
            {{ form.as_table }}
        </table>
        <input type="submit" value="Add Time Slot">
    </form>

    <p><a href="{% url 'teachers:delete_term' room.id term.id %}" onclick="return confirm('Are you sure?')">Delete this Term</a></p>

{% endblock %}